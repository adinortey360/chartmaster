<!DOCTYPE html>
<html>
<head>
	<title>Grouped Bar Chart</title>
	<style>
		canvas {
			border: 1px solid black;
		}
	</style>
</head>
<body>
	<canvas id="canvas"></canvas>
	<script>
		const canvas = document.getElementById("canvas");
		const ctx = canvas.getContext("2d");
		
		// Data for the chart
		const data = [
			{ label: "Monday", values: [10, 20] },
			{ label: "Tuesday", values: [15, 25] },
      { label: "Wednesday", values: [20, 30] },
      { label: "Thursday", values: [25, 35] },
      { label: "Friday", values: [15, 40] },
      { label: "Saturday", values: [10, 45] },
      { label: "Sunday", values: [40, 50] }
		];
		
		// Colors for the bars
		const colors = ["#DFE7EE", "#65BB64"];
		
		// Set the dimensions of the canvas
		canvas.width = 800;
		canvas.height = 400;
		
		// Padding between bars and chart edges
		const padding = 10;
		
		// Calculate the maximum value for the data
		const maxValue = Math.max(...data.flatMap(group => group.values));
		
		// Calculate the width and height of each bar
		const barWidth = (canvas.width - padding * 2) / (data.length * data[0].values.length);
		const barHeight = (canvas.height - padding * 2) / maxValue;
		
		// Draw the bars
		data.forEach((group, groupIndex) => {
			group.values.forEach((value, valueIndex) => {
				const x = padding + (groupIndex * barWidth * group.values.length) + (valueIndex * barWidth);
				const y = canvas.height - padding - (value * barHeight);
				const width = barWidth - padding * 2;
				const height = value * barHeight - padding * 2;
				ctx.fillStyle = colors[valueIndex];
				ctx.beginPath();
				ctx.moveTo(x + padding, y);
				ctx.lineTo(x + width - padding, y);
				ctx.quadraticCurveTo(x + width, y, x + width, y + padding);
				ctx.lineTo(x + width, y + height - padding);
				ctx.quadraticCurveTo(x + width, y + height, x + width - padding, y + height);
				ctx.lineTo(x + padding, y + height);
				ctx.quadraticCurveTo(x, y + height, x, y + height - padding);
				ctx.lineTo(x, y + padding);
				ctx.quadraticCurveTo(x, y, x + padding, y);
				ctx.closePath();
				ctx.fill();

        // when the mouse is over the bar, draw a tooltip
        canvas.addEventListener("mousemove", e => {
          const rect = canvas.getBoundingClientRect();
          const x = e.clientX - rect.left;
          const y = e.clientY - rect.top;
          if (x >= x && x <= x + width && y >= y && y <= y + height) {
            ctx.fillStyle = "#000";
            ctx.textAlign = "center";
            ctx.textBaseline = "middle";
            ctx.font = "bold 12px sans-serif";
            ctx.fillText(value, x + width / 2, y + height / 2);
          }
        });

			});

      // Draw the labels at the bottom tilted if there are more than 5 bars
      const labelX = padding + (groupIndex * barWidth * group.values.length) + (group.values.length * barWidth / 2);
      const labelY = canvas.height - padding;
      ctx.fillStyle = "#000";
      ctx.textAlign = "center";
      ctx.textBaseline = "top";
      ctx.font = "bold 12px sans-serif";
      ctx.save();

      if (data.length > 10) {
        ctx.translate(labelX, labelY);
        ctx.rotate(-Math.PI / 4);
        ctx.fillText(group.label, 0, 0);
        ctx.restore();
      } else {
        ctx.fillText(group.label, labelX, labelY);
      }
		});
	</script>
</body>
</html>
